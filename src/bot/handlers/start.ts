import { Context } from 'telegraf';
import { ensureUser } from '../../services/database.js';

export async function handleStart(ctx: Context) {
  if (!ctx.from) return;

  const userId = BigInt(ctx.from.id);
  
  await ensureUser(userId, {
    username: ctx.from.username,
    firstName: ctx.from.first_name,
    lastName: ctx.from.last_name,
  });

  const welcomeMessage = `
üé¨ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Romantic Flick Bot! ‚ù§Ô∏è

–Ø —Å–æ–∑–¥–∞—é —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –≤–∏–¥–µ–æ –∏–∑ –≤–∞—à–∏—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π!

üì∏ **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ 2 —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
2. –Ø –æ–±—ä–µ–¥–∏–Ω—é –∏—Ö –≤ —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫—É—é —Å—Ü–µ–Ω—É
3. –°–æ–∑–¥–∞–º –º–∏–ª–æ–µ –≤–∏–¥–µ–æ, –≥–¥–µ –æ–¥–∏–Ω —á–µ–ª–æ–≤–µ–∫ –∏–≥—Ä–∏–≤–æ —â–µ–ª–∫–∞–µ—Ç –ø–æ –Ω–æ—Å—É –¥—Ä—É–≥–æ–≥–æ

‚ú® **–ß—Ç–æ –≤–∞–∂–Ω–æ:**
‚Ä¢ –õ–∏—Ü–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ö–æ—Ä–æ—à–æ –≤–∏–¥–Ω—ã –Ω–∞ —Ñ–æ—Ç–æ
‚Ä¢ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —á–µ—Ç–∫–∏–º–∏
‚Ä¢ –õ—É—á—à–µ –≤—Å–µ–≥–æ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ—Ä—Ç—Ä–µ—Ç–Ω—ã–µ —Ñ–æ—Ç–æ

üíé **–õ–∏–º–∏—Ç—ã:**
‚Ä¢ –£ –≤–∞—Å 1 –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
‚Ä¢ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å –∑–∞ Telegram Stars

**–ö–æ–º–∞–Ω–¥—ã:**
/generate - –ù–∞—á–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ
/balance - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
/buy - –ö—É–ø–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
/cancel - –û—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –æ–ø–µ—Ä–∞—Ü–∏—é
/help - –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É

–ì–æ—Ç–æ–≤—ã —Å–æ–∑–¥–∞—Ç—å —Ä–æ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –≤–∏–¥–µ–æ? –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /generate! üöÄ
`;

  await ctx.reply(welcomeMessage);
}

